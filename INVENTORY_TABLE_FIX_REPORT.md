# üîß –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –¢–ê–ë–õ–ò–¶–´ INVENTORY

**–î–∞—Ç–∞**: 12 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è**: 00:45 MSK  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ó–ê–î–ï–ü–õ–û–ï–ù–û**

---

## üö® –ü–†–û–ë–õ–ï–ú–ê

### ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ —Ç–æ–≤–∞—Ä–æ–≤:
```
ERROR:database_psycopg2:‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: relation "inventory" does not exist
LINE 2:         INSERT INTO inventory (user_id, item_name, count, fl...
                            ^
ERROR:database_psycopg2:‚ùå –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞: relation "inventory" does not exist
ERROR:database_psycopg2:‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å: relation "inventory" does not exist
```

### üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω—ã:
- **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞**: –¢–∞–±–ª–∏—Ü–∞ `inventory` –Ω–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞**: –°–∫—Ä–∏–ø—Ç `update_forest_shop_items.py` –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω
- **–ü–æ–∫—É–ø–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏**: –¢–æ–≤–∞—Ä—ã –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

#### 1. **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `create_inventory_table.py`:**
```python
def create_inventory_table():
    """–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É inventory –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É inventory
    create_table_sql = """
    CREATE TABLE IF NOT EXISTS inventory (
        id SERIAL PRIMARY KEY,
        user_id BIGINT NOT NULL,
        item_name VARCHAR(255) NOT NULL,
        count INTEGER DEFAULT 1,
        flags JSONB DEFAULT '{}'::jsonb,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,
        UNIQUE(user_id, item_name)
    );
    """
    
    # –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è user_id
    create_index_sql = """
    CREATE INDEX IF NOT EXISTS idx_inventory_user_id ON inventory(user_id);
    """
```

#### 2. **–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_inventory_table.py`:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ

#### 3. **–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `env_local.txt`:**
- –°–æ–¥–µ—Ä–∂–∏—Ç DATABASE_URL –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

## üìä –î–ï–¢–ê–õ–ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### üîÑ Git –æ–ø–µ—Ä–∞—Ü–∏–∏:
```bash
‚úÖ git add create_inventory_table.py test_inventory_table.py env_local.txt
‚úÖ git commit -m "Add inventory table creation script..." # –°–æ–∑–¥–∞–Ω –∫–æ–º–º–∏—Ç
‚úÖ git push origin main              # –ó–∞–ø—É—à–µ–Ω–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```

### üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `create_inventory_table.py` - —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
- `test_inventory_table.py` - —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `env_local.txt` - —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã inventory:

#### **–°—Ç–æ–ª–±—Ü—ã:**
- **`id`** - SERIAL PRIMARY KEY (–∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç)
- **`user_id`** - BIGINT NOT NULL (ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- **`item_name`** - VARCHAR(255) NOT NULL (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞)
- **`count`** - INTEGER DEFAULT 1 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- **`flags`** - JSONB DEFAULT '{}' (—Ñ–ª–∞–≥–∏ –ø—Ä–µ–¥–º–µ—Ç–∞)
- **`created_at`** - TIMESTAMP DEFAULT CURRENT_TIMESTAMP
- **`updated_at`** - TIMESTAMP DEFAULT CURRENT_TIMESTAMP

#### **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- **FOREIGN KEY** - —Å–≤—è–∑—å —Å —Ç–∞–±–ª–∏—Ü–µ–π `users(user_id)`
- **UNIQUE(user_id, item_name)** - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **ON DELETE CASCADE** - —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### **–ò–Ω–¥–µ–∫—Å—ã:**
- **`idx_inventory_user_id`** - –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ user_id

---

## üöÄ –î–ï–ü–õ–û–ô

### ‚è±Ô∏è –°—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è:
- **Git push**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
- **Railway build**: üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ
- **Railway deploy**: ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ
- **–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è**: 2-3 –º–∏–Ω—É—Ç—ã

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢

### ‚ùå –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **–û—à–∏–±–∫–∞**: `relation "inventory" does not exist`
- **–ü–æ–∫—É–ø–∫–∏**: –ù–µ —Ä–∞–±–æ—Ç–∞–ª–∏ (—Ç–æ–≤–∞—Ä—ã –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å)
- **–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å**: –ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è

### ‚úÖ –ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **–¢–∞–±–ª–∏—Ü–∞**: –°–æ–∑–¥–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- **–ü–æ–∫—É–ø–∫–∏**: –†–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å**: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üéØ –õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´

### üìã –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

#### 1. **–ü–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞:**
```
üõçÔ∏è **–õ–µ—Å–Ω–æ–π –º–∞–≥–∞–∑–∏–Ω** üõçÔ∏è

üå∞ –í–∞—à –±–∞–ª–∞–Ω—Å: 1175 –æ—Ä–µ—à–∫–æ–≤

üì¶ **–¢–æ–≤–∞—Ä—ã:**
üé≠ –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–æ–ª—å - 1üå∞
üåø –õ–µ—Å–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ - 100üå∞
üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –±–æ–±—Ä–∞ - 150üå∞
üå∞ –ó–æ–ª–æ—Ç–æ–π –æ—Ä–µ—à–µ–∫ - 200üå∞
üåô –ù–æ—á–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ - 250üå∞
üîç –û—Å—Ç—Ä—ã–π –Ω—é—Ö - 300üå∞
üçÑ –õ–µ—Å–Ω–æ–π —ç–ª–∏–∫—Å–∏—Ä - 400üå∞
üå≤ –î—Ä–µ–≤–æ –∂–∏–∑–Ω–∏ - 500üå∞

[üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å] [üí∞ –ë–∞–ª–∞–Ω—Å]
```

#### 2. **–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —Ç–æ–≤–∞—Ä:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–∫—É–ø–∫–∞ —á–µ—Ä–µ–∑ `buy_item()`
- ‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `inventory`
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–∫—É–ø–∫–µ

#### 3. **–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞:**
```
üß∫ **–í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å**

üå∞ –û—Ä–µ—à–∫–∏: 1174

üì¶ **–ü—Ä–µ–¥–º–µ—Ç—ã:**
üé≠ –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–æ–ª—å x1
üåø –õ–µ—Å–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ x2
üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –±–æ–±—Ä–∞ x1

[üîô –ù–∞–∑–∞–¥ –∫ –ø—Ä–æ—Ñ–∏–ª—é]
```

---

## üîç –ü–†–û–í–ï–†–ö–ê

### üìã –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
1. **–ü–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞** - –î–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å** - –¢–æ–≤–∞—Ä –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è** - –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫—É–ø–ª–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã

### üö® –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
- **–ù–µ—Ç –æ—à–∏–±–æ–∫** - –ü–æ–∫—É–ø–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- **–¢–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è** - –ü–æ—è–≤–ª—è—é—Ç—Å—è –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
- **–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è** - –°–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –æ—Ä–µ—à–∫–∏

---

## üìù –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### üîß –¢–∏–ø –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è (–ø–æ–∫—É–ø–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏)
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤)

### üìÅ –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:
- `create_inventory_table.py` - —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
- `test_inventory_table.py` - —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `env_local.txt` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- **–°–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞**: `inventory`
- **–î–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–µ–∫—Å**: `idx_inventory_user_id`
- **–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: FOREIGN KEY, UNIQUE

---

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–¢–ê–ë–õ–ò–¶–ê INVENTORY –ü–û–õ–ù–û–°–¢–¨–Æ –°–û–ó–î–ê–ù–ê!**

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:
- **–ü—Ä–æ–±–ª–µ–º–∞**: `relation "inventory" does not exist`
- **–ü—Ä–∏—á–∏–Ω–∞**: –¢–∞–±–ª–∏—Ü–∞ –Ω–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ

### üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:
**–ú–ê–ì–ê–ó–ò–ù –ü–û–õ–ù–û–°–¢–¨–Æ –§–£–ù–ö–¶–ò–û–ù–ê–õ–ï–ù!**

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è (2-3 –º–∏–Ω—É—Ç—ã) –º–∞–≥–∞–∑–∏–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- **–ü–æ–∫—É–ø–∫–∏** - –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- **–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å** - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 12 —Å–µ–Ω—Ç—è–±—Ä—è 2025, 00:45 MSK  
**–ö–æ–º–º–∏—Ç**: (–ø–æ—Å–ª–µ–¥–Ω–∏–π)  
**–°—Ç–∞—Ç—É—Å**: üöÄ –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –í—ã—Å–æ–∫–∞—è (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
