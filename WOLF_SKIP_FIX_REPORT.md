# üê∫ –û–¢–ß–Å–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –ü–†–û–ë–õ–ï–ú–´ –° –ü–†–û–ü–£–°–ö–û–ú –•–û–î–ê –í–û–õ–ö–ê

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª, —á—Ç–æ –≤–æ–ª–∫ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –Ω–æ—á—å - –µ–º—É –ø–∏—à–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ö–æ–¥".

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:

1. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ callback'–æ–≤**
   - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `handle_night_action_callback` —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º `^wolf_` –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å `wolf_skip`

2. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –≤ callback_handler.py**
   - –ú–µ—Ç–æ–¥ `_handle_wolf_action` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É `skip`
   - –õ–æ–≥–∏–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π

3. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–∞ skip_action –≤ NightActions**
   - –ú–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–≥—Ä–æ–∫–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ skipped_actions –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è

4. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ NightActions**
   - NightActions —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–≥—Ä—ã
   - –ï—Å—Ç—å fallback –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è NightActions –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç

## üîß –í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ callback_handler.py

**–§–∞–π–ª:** `callback_handler.py`
**–ú–µ—Ç–æ–¥:** `_handle_wolf_action`

```python
# –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–æ –º–µ—Ç–æ–¥–∞
self.logger.info(f"üîç _handle_wolf_action: –ü–æ–ª—É—á–µ–Ω callback –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}, parts: {parts}")

# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–∫–∞
if not player or player.role != Role.WOLF:
    self.logger.warning(f"‚ö†Ô∏è _handle_wolf_action: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ –≤–æ–ª–∫ (—Ä–æ–ª—å: {player.role if player else 'None'})")
    await query.answer("‚ùå –í—ã –Ω–µ –≤–æ–ª–∫!", show_alert=True)
    return

# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–∑—ã –∏–≥—Ä—ã
if game.phase != GamePhase.NIGHT:
    self.logger.warning(f"‚ö†Ô∏è _handle_wolf_action: –ù–µ –Ω–æ—á–Ω–∞—è —Ñ–∞–∑–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id} (—Ñ–∞–∑–∞: {game.phase})")
    await query.answer("‚ùå –°–µ–π—á–∞—Å –Ω–µ –Ω–æ—á–Ω–∞—è —Ñ–∞–∑–∞!", show_alert=True)
    return
```

### 2. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞ —Ö–æ–¥–∞

**–§–∞–π–ª:** `callback_handler.py`
**–°–µ–∫—Ü–∏—è:** –æ–±—Ä–∞–±–æ—Ç–∫–∞ `elif len(parts) >= 2 and parts[1] == "skip"`

```python
# –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
self.logger.info(f"üîç –û–ë–†–ê–ë–û–¢–ö–ê –ü–†–û–ü–£–°–ö–ê –•–û–î–ê: {parts[0]}_skip –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")

# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä–æ–∫–∞
player = game.players.get(user_id)
if player:
    self.logger.info(f"üîç –ò–≥—Ä–æ–∫ –Ω–∞–π–¥–µ–Ω: {player.role}, –∂–∏–≤: {player.is_alive}")
else:
    self.logger.error(f"‚ùå –ò–≥—Ä–æ–∫ {user_id} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∏–≥—Ä–µ {game.chat_id}")
    await query.answer("‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!", show_alert=True)
    return
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ NightActions

**–§–∞–π–ª:** `night_actions.py`
**–ú–µ—Ç–æ–¥:** `skip_action`

```python
def skip_action(self, player_id: int) -> bool:
    """–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –Ω–æ—á–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –∏–≥—Ä–æ–∫–∞"""
    import logging
    logger = logging.getLogger(__name__)
    
    logger.info(f"üîç skip_action: –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ö–æ–¥ –¥–ª—è –∏–≥—Ä–æ–∫–∞ {player_id}")
    
    player = self.game.players.get(player_id)
    if not player:
        logger.error(f"‚ùå skip_action: –ò–≥—Ä–æ–∫ {player_id} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∏–≥—Ä–µ")
        return False
    
    if not player.is_alive:
        logger.error(f"‚ùå skip_action: –ò–≥—Ä–æ–∫ {player_id} –Ω–µ –∂–∏–≤")
        return False
    
    logger.info(f"‚úÖ skip_action: –ò–≥—Ä–æ–∫ {player_id} ({player.role}) –Ω–∞–π–¥–µ–Ω –∏ –∂–∏–≤")
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–ø—É—Å—Ç–∏–≤—à–∏—Ö
    self.skipped_actions.add(player_id)
    logger.info(f"‚úÖ skip_action: –ò–≥—Ä–æ–∫ {player_id} –¥–æ–±–∞–≤–ª–µ–Ω –≤ skipped_actions")
    
    # –£–¥–∞–ª—è–µ–º –∏–∑ –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤ —Ü–µ–ª–µ–π (–µ—Å–ª–∏ –±—ã–ª)
    removed_from = []
    if player_id in self.wolf_targets:
        self.wolf_targets.pop(player_id, None)
        removed_from.append("wolf_targets")
    # ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–æ–ª–µ–π
    
    if removed_from:
        logger.info(f"‚úÖ skip_action: –ò–≥—Ä–æ–∫ {player_id} —É–¥–∞–ª–µ–Ω –∏–∑: {', '.join(removed_from)}")
    
    logger.info(f"‚úÖ skip_action: –•–æ–¥ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω –¥–ª—è –∏–≥—Ä–æ–∫–∞ {player_id}")
    return True
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –≥–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞
2. **‚úÖ –õ—É—á—à–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –ª–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã, –∏–≥—Ä–æ–∫–∞ –∏ NightActions
3. **‚úÖ –ë–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –æ—à–∏–±–∫–∏** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–±–ª–µ–º–µ

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã (—Ç–µ–ø–µ—Ä—å –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –≤ –ª–æ–≥–∞—Ö):

1. **‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –∏–≥—Ä–µ
2. **‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–æ–ª—å** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–æ–ª–∫
3. **‚ùå –ù–µ –Ω–æ—á–Ω–∞—è —Ñ–∞–∑–∞** - –∏–≥—Ä–∞ –Ω–µ –≤ –Ω–æ—á–Ω–æ–π —Ñ–∞–∑–µ
4. **‚ùå NightActions –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã** - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
5. **‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –∂–∏–≤** - –∏–≥—Ä–æ–∫ —É–∂–µ –∏—Å–∫–ª—é—á—ë–Ω –∏–∑ –∏–≥—Ä—ã

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤** - —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø—Ä–æ–ø—É—Å–∫–∞ —Ö–æ–¥–∞ –≤–æ–ª–∫–æ–º
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞, –ª–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É

## üìä –°—Ç–∞—Ç—É—Å

- **‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã** - –∑–∞–≤–µ—Ä—à—ë–Ω
- **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã** - –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- **‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
- **‚è≥ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ–∂–∏–¥–∞–µ—Ç—Å—è

---
*–û—Ç—á—ë—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–°—Ç–∞—Ç—É—Å: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í–ù–ï–°–ï–ù–´*
