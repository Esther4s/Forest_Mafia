# ะะธะฐะณัะฐะผะผะฐ ะฟะตัะตัะพะดะพะฒ ะผะตะถะดั ัะฐะทะฐะผะธ ะธะณัั

## ๐ ะะพะปะฝัะน ัะธะบะป ัะฐะท ะธะณัั

```
โโโโโโโโโโโโโโโ    start_night_phase()    โโโโโโโโโโโโโโโ
โ   WAITING   โ โโโโโโโโโโโโโโโโโโโโโโโโโบ โ    NIGHT    โ
โ   (ะะถะธะดะฐะฝะธะต)โ                           โ   (ะะพัั)    โ
โโโโโโโโโโโโโโโ                           โโโโโโโโโโโโโโโ
                                                โ
                                                โ (60 ัะตะบ)
                                                โผ
โโโโโโโโโโโโโโโ    start_day_phase()      โโโโโโโโโโโโโโโ
โ   VOTING    โ โโโโโโโโโโโโโโโโโโโโโโโโโ โ     DAY     โ
โ (ะะพะปะพัะพะฒะฐะฝะธะต)โ                           โ   (ะะตะฝั)    โ
โโโโโโโโโโโโโโโ                           โโโโโโโโโโโโโโโ
       โฒ                                         โ
       โ                                         โ (5 ะผะธะฝ)
       โ                                         โผ
       โ                                โโโโโโโโโโโโโโโ
       โ                                โ   TIMER     โ
       โ                                โ (ะขะฐะนะผะตั ะดะฝั)โ
       โ                                โโโโโโโโโโโโโโโ
       โ                                         โ
       โ                                         โ
       โ start_voting_phase()                    โ
       โ (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธะปะธ ะดะพััะพัะฝะพ)            โ
       โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะตัะฐะปัะฝะพะต ะพะฟะธัะฐะฝะธะต ะฟะตัะตัะพะดะพะฒ

### 1. WAITING โ NIGHT
- **ะขัะธะณะณะตั**: `start_game()` โ `start_night_phase()`
- **ะะตะนััะฒะธั**:
  - ะะฐัะฟัะตะดะตะปะตะฝะธะต ัะพะปะตะน
  - ะัะฟัะฐะฒะบะฐ ัะพะปะตะน ะธะณัะพะบะฐะผ ะฒ ะะก
  - ะะฐะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธั ะฝะพัะธ
  - ะะฐะฟััะบ ัะฐะนะผะตัะฐ ะฝะพัะธ (60 ัะตะบัะฝะด)

### 2. NIGHT โ DAY
- **ะขัะธะณะณะตั**: ะะฐะฒะตััะตะฝะธะต ะฝะพัะฝัั ะดะตะนััะฒะธะน (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธะปะธ ะดะพััะพัะฝะพ)
- **ะะตะนััะฒะธั**:
  - ะะฑัะฐะฑะพัะบะฐ ะฝะพัะฝัั ะดะตะนััะฒะธะน
  - ะัะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธั ะฝะพัะธ
  - ะะฐะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธั ะดะฝั
  - ะะฐะฟััะบ ัะฐะนะผะตัะฐ ะดะฝั (5 ะผะธะฝัั)

### 3. DAY โ VOTING
- **ะขัะธะณะณะตัั**:
  - **ะะฒัะพะผะฐัะธัะตัะบะธ**: ะััะตัะตะฝะธะต 5 ะผะธะฝัั (`day_phase_timer`)
  - **ะะพััะพัะฝะพ**: ะะฝะพะฟะบะฐ "๐ ะะฐะฒะตััะธัั ะพะฑััะถะดะตะฝะธะต" (`day_end_discussion`)
- **ะะตะนััะฒะธั**:
  - ะัะผะตะฝะฐ ัะฐะนะผะตัะฐ ะดะฝั (ะตัะปะธ ะดะพััะพัะฝะพ)
  - ะัะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธั ะดะฝั
  - ะะฐะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธั ะณะพะปะพัะพะฒะฐะฝะธั
  - ะัะฟัะฐะฒะบะฐ ะผะตะฝั ะณะพะปะพัะพะฒะฐะฝะธั ะฒ ะะก
  - ะะฐะฟััะบ ัะฐะนะผะตัะฐ ะณะพะปะพัะพะฒะฐะฝะธั (2 ะผะธะฝััั)

### 4. VOTING โ NIGHT
- **ะขัะธะณะณะตัั**:
  - **ะะฒัะพะผะฐัะธัะตัะบะธ**: ะััะตัะตะฝะธะต 2 ะผะธะฝัั (`voting_timer`)
  - **ะะพััะพัะฝะพ**: ะัะต ะธะณัะพะบะธ ะฟัะพะณะพะปะพัะพะฒะฐะปะธ
- **ะะตะนััะฒะธั**:
  - ะะฑัะฐะฑะพัะบะฐ ัะตะทัะปััะฐัะพะฒ ะณะพะปะพัะพะฒะฐะฝะธั (`process_voting_results`)
  - ะัะพะฒะตัะบะฐ ััะปะพะฒะธะน ะพะบะพะฝัะฐะฝะธั ะธะณัั
  - ะัะปะธ ะธะณัะฐ ะฟัะพะดะพะปะถะฐะตััั: `start_new_night()` โ `start_night_phase()`
  - ะัะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธั ะณะพะปะพัะพะฒะฐะฝะธั
  - ะะฐะบัะตะฟะปะตะฝะธะต ะฝะพะฒะพะณะพ ัะพะพะฑัะตะฝะธั ะฝะพัะธ

## ๐ง ะะพััะพัะฝะพะต ะทะฐะฒะตััะตะฝะธะต

### ะะพััะพัะฝะพะต ะทะฐะฒะตััะตะฝะธะต ะดะฝั
```python
# ะะฝะพะฟะบะฐ "๐ ะะฐะฒะตััะธัั ะพะฑััะถะดะตะฝะธะต"
if query.data == "day_end_discussion":
    # ะัะผะตะฝัะตะผ ัะฐะนะผะตั ะดะฝะตะฒะฝะพะน ัะฐะทั
    game.cancel_day_timer()
    
    # ะะตัะตัะพะดะธะผ ะบ ะณะพะปะพัะพะฒะฐะฝะธั
    await self.start_voting_phase(mock_update, context, game)
```

### ะะพััะพัะฝะพะต ะทะฐะฒะตััะตะฝะธะต ะณะพะปะพัะพะฒะฐะฝะธั
```python
# ะัะต ะธะณัะพะบะธ ะฟัะพะณะพะปะพัะพะฒะฐะปะธ
if all_players_voted:
    await self.process_voting_results(update, context, game)
```

## ๐ฏ ะะปััะตะฒัะต ะพัะพะฑะตะฝะฝะพััะธ

### 1. ะฃะฟัะฐะฒะปะตะฝะธะต ัะฐะนะผะตัะฐะผะธ
- **ะะฝะตะฒะฝะพะน ัะฐะนะผะตั**: ะกะพััะฐะฝัะตััั ัััะปะบะฐ ะฝะฐ ะทะฐะดะฐัั, ะผะพะถะตั ะฑััั ะพัะผะตะฝะตะฝ
- **ะะพัะฝะพะน ัะฐะนะผะตั**: ะัะพะฒะตััะตั ะทะฐะฒะตััะตะฝะธะต ะฒัะตั ะฝะพัะฝัั ะดะตะนััะฒะธะน
- **ะขะฐะนะผะตั ะณะพะปะพัะพะฒะฐะฝะธั**: ะัะพะฒะตััะตั, ะฒัะต ะปะธ ะธะณัะพะบะธ ะฟัะพะณะพะปะพัะพะฒะฐะปะธ

### 2. ะะฐะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธะน
- ะะฐะถะดะฐั ัะฐะทะฐ ะทะฐะบัะตะฟะปัะตั ัะฒะพะต ัะพะพะฑัะตะฝะธะต
- ะัะธ ะฟะตัะตัะพะดะต ะบ ัะปะตะดัััะตะน ัะฐะทะต ะพัะบัะตะฟะปัะตััั ัะพะพะฑัะตะฝะธะต ะฟัะตะดัะดััะตะน
- ะัะธ ะทะฐะฒะตััะตะฝะธะธ ะธะณัั ะพัะบัะตะฟะปััััั ะฒัะต ัะพะพะฑัะตะฝะธั

### 3. ะะธะฐะณะฝะพััะธะบะฐ
- ะะฝะพะฟะบะฐ "๐ ะะธะฐะณะฝะพััะธะบะฐ ัะฐะนะผะตัะฐ" ะฒะพ ะฒัะตะผั ะดะฝั
- ะะพะบะฐะทัะฒะฐะตั ััะฐััั ัะฐะนะผะตัะฐ, ะฒัะตะผั ั ะฝะฐัะฐะปะฐ ัะฐะทั
- ะะพะผะพะณะฐะตั ะฒัััะฝะธัั ะฟัะพะฑะปะตะผั ั ัะฐะนะผะตัะพะผ

## โ ะัะพะฒะตัะตะฝะฝัะต ััะตะฝะฐัะธะธ

1. **ะะพัะผะฐะปัะฝัะน ัะธะบะป**: ะะพัั โ ะะตะฝั โ ะะพะปะพัะพะฒะฐะฝะธะต โ ะะพัั
2. **ะะพััะพัะฝะพะต ะทะฐะฒะตััะตะฝะธะต ะดะฝั**: ะะฝะพะฟะบะฐ "ะะฐะฒะตััะธัั ะพะฑััะถะดะตะฝะธะต"
3. **ะะพััะพัะฝะพะต ะทะฐะฒะตััะตะฝะธะต ะณะพะปะพัะพะฒะฐะฝะธั**: ะัะต ะธะณัะพะบะธ ะฟัะพะณะพะปะพัะพะฒะฐะปะธ
4. **ะัะผะตะฝะฐ ัะฐะนะผะตัะฐ**: ะัะธ ะดะพััะพัะฝะพะผ ะทะฐะฒะตััะตะฝะธะธ ะธะปะธ ะทะฐะฒะตััะตะฝะธะธ ะธะณัั
5. **ะะธะฐะณะฝะพััะธะบะฐ ัะฐะนะผะตัะฐ**: ะัะพะฒะตัะบะฐ ััะฐัััะฐ ะฒะพ ะฒัะตะผั ะดะฝั

## ๐ ะะตะทัะปััะฐั

ะะพะณะธะบะฐ ะฟะตัะตัะพะดะพะฒ ะผะตะถะดั ัะฐะทะฐะผะธ ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ:
- โ ะะพัะปะต ะณะพะปะพัะพะฒะฐะฝะธั ะดะตะนััะฒะธัะตะปัะฝะพ ะฝะฐัััะฟะฐะตั ะฝะพัั
- โ ะะพััะพัะฝะพะต ะทะฐะฒะตััะตะฝะธะต ะพะฑััะถะดะตะฝะธั ัะฐะฑะพัะฐะตั ะฟัะฐะฒะธะปัะฝะพ
- โ ะขะฐะนะผะตัั ะบะพััะตะบัะฝะพ ะพัะผะตะฝััััั ะฟัะธ ะดะพััะพัะฝะพะผ ะทะฐะฒะตััะตะฝะธะธ
- โ ะะฐะบัะตะฟะปะตะฝะธะต ัะพะพะฑัะตะฝะธะน ัะฐะฑะพัะฐะตั ะดะปั ะฒัะตั ัะฐะท
- โ ะะธะฐะณะฝะพััะธะบะฐ ะฟะพะผะพะณะฐะตั ะฒัััะฝะธัั ะฟัะพะฑะปะตะผั ั ัะฐะนะผะตัะฐะผะธ
