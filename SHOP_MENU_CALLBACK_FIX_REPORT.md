# üõçÔ∏è –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û–±—Ä–∞–±–æ—Ç–∫–∞ shop_menu –≤ callback_handler.py

## üõçÔ∏è –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ "üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω" –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ—Ä–µ–∑ callback. –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ callback `shop_menu` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `callback_handler.py`.

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ shop_menu –≤ callback_handlers
**–§–∞–π–ª**: `callback_handler.py`, –º–µ—Ç–æ–¥ `_setup_handlers`
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è `shop_menu` callback

```python
# –î–æ–±–∞–≤–ª–µ–Ω–æ:
"shop_menu": self._handle_shop_menu,
```

### 2. –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ _handle_shop_menu
**–§–∞–π–ª**: `callback_handler.py`, –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ —á–µ—Ä–µ–∑ callback_handler

```python
async def _handle_shop_menu(self, query: CallbackQuery, context: ContextTypes.DEFAULT_TYPE, parts: list):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞"""
    try:
        user_id = query.from_user.id
        self.logger.info(f"üõçÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ shop_menu –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
        
        # –ü–æ–ª—É—á–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
        from bot import ForestWolvesBot
        bot_instance = ForestWolvesBot.get_instance()
        
        # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä, –ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã
        if not bot_instance:
            try:
                import bot
                if hasattr(bot, 'bot_instance') and bot.bot_instance:
                    bot_instance = bot.bot_instance
                    self.logger.info(f"‚úÖ –ù–∞–π–¥–µ–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é")
                else:
                    # –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä —á–µ—Ä–µ–∑ sys.modules
                    import sys
                    for module_name, module in sys.modules.items():
                        if hasattr(module, 'bot_instance') and module.bot_instance:
                            bot_instance = module.bot_instance
                            self.logger.info(f"‚úÖ –ù–∞–π–¥–µ–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å {module_name}")
                            break
            except Exception as e:
                self.logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞: {e}")
        
        if bot_instance:
            # –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ show_shop_menu –∏–∑ bot.py
            await bot_instance.show_shop_menu(query, context)
        else:
            await query.answer("‚ùå –ë–æ—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω!", show_alert=True)
            
    except Exception as e:
        self.logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–∞–≥–∞–∑–∏–Ω–∞: {e}")
        await query.answer("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞!", show_alert=True)
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ö–Ω–æ–ø–∫–∞ "üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω" –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- Callback `shop_menu` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è –≤ `callback_handler.py`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –æ—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω

### ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ö–Ω–æ–ø–∫–∞ "üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω" –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ callback
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ `show_shop_menu` –∏–∑ `bot.py`
- –ú–∞–≥–∞–∑–∏–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ callback'–æ–≤:
1. **callback_handler.py** - –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ callback'–æ–≤
2. **bot.py** - —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
3. **callback_handler.py** –ø–æ–ª—É—á–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫:
- `shop_menu` ‚Üí `_handle_shop_menu` ‚Üí `bot_instance.show_shop_menu()`
- `inventory_menu` ‚Üí `_handle_inventory_menu` ‚Üí `bot_instance.show_inventory()`

## üöÄ –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –ö–Ω–æ–ø–∫–∞ "üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω" —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –¥–ª—è `inventory_menu`
- –û–±–∞ callback'–∞ —Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
