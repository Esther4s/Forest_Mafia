# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö –í –ù–û–ß–ù–´–• –î–ï–ô–°–¢–í–ò–Ø–•

## üéØ **–ü–†–û–ë–õ–ï–ú–´**

### ‚ùå **–û—à–∏–±–∫–∞ 1: AttributeError –≤ night_actions.py**
```
AttributeError: 'Game' object has no attribute 'herbivore_survivals'
```
**–ú–µ—Å—Ç–æ –æ—à–∏–±–∫–∏:** `night_actions.py:189` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∞—Ç—Ä–∏–±—É—Ç–∞–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä—ã

### ‚ùå **–û—à–∏–±–∫–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ end_game_winner**
```
await self.end_game_winner(fake_update, context, game, winner)
```
**–ú–µ—Å—Ç–æ –æ—à–∏–±–∫–∏:** `bot.py:3957` –∏ `bot.py:2445` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞

### ‚ùå **–û—à–∏–±–∫–∞ 3: –ò–≥—Ä–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–±–µ–¥–µ –≤–æ–ª–∫–æ–≤**
–õ–æ–≥–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã —Ä–∞–±–æ—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –±—ã–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

---

## ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ night_actions.py**

**–ë—ã–ª–æ:**
```python
# –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
if target.team == Team.HERBIVORES:
    self.game.game_stats.herbivore_survivals += 1
self.game.game_stats.predator_kills += 1
```

**–°—Ç–∞–ª–æ:**
```python
# –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
self.game.game_stats.predator_kills += 1
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:** –ö–æ–≥–¥–∞ –≤–æ–ª–∫–∏ —É–±–∏–≤–∞—é—Ç —Ç—Ä–∞–≤–æ—è–¥–Ω–æ–≥–æ, —ç—Ç–æ –¥–æ–ª–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `predator_kills`, –∞ –Ω–µ `herbivore_survivals`.

### **2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã end_game_winner –≤ bot.py**

**–ë—ã–ª–æ:**
```python
# –°–æ–∑–¥–∞–µ–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π update –¥–ª—è end_game_winner
from telegram import Update
fake_update = Update(update_id=0)
await self.end_game_winner(fake_update, context, game, winner)
```

**–°—Ç–∞–ª–æ:**
```python
await self.end_game_winner(context, game, winner)
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:** –ú–µ—Ç–æ–¥ `end_game_winner` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `(context, game, winner)`, –∞ –Ω–µ `(update, context, game, winner)`.

### **3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –º–µ—Å—Ç–∞ –≤—ã–∑–æ–≤–∞ end_game_winner**

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã –≤:
- `bot.py:3957` - –≤ –º–µ—Ç–æ–¥–µ `process_night_phase`
- `bot.py:2445` - –≤ –º–µ—Ç–æ–¥–µ `start_day_phase`

---

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_night_actions_fix.py`**

–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É–±–∏–π—Å—Ç–≤ –≤–æ–ª–∫–æ–≤
2. ‚úÖ –£—Å–ª–æ–≤–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
3. ‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–±–µ–¥—ã —Ö–∏—â–Ω–∏–∫–æ–≤
4. ‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–±–µ–¥—ã —Ç—Ä–∞–≤–æ—è–¥–Ω—ã—Ö
5. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤ –Ω–æ—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö

### **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 5
- **–ü—Ä–æ–π–¥–µ–Ω–æ**: 5 (100%)
- **–ü—Ä–æ–≤–∞–ª–µ–Ω–æ**: 0 (0%)
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å**: 100%

---

## üéÆ **–†–ï–ó–£–õ–¨–¢–ê–¢**

### ‚úÖ **–ù–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫:**
- –í–æ–ª–∫–∏ –º–æ–≥—É—Ç —É–±–∏–≤–∞—Ç—å –∏–≥—Ä–æ–∫–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–±–µ–¥–µ –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
- `predator_kills` - —É–±–∏–π—Å—Ç–≤–∞ —Ö–∏—â–Ω–∏–∫–æ–≤
- `herbivore_survivals` - –≤—ã–∂–∏–≤–∞–Ω–∏—è —Ç—Ä–∞–≤–æ—è–¥–Ω—ã—Ö (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö)
- `fox_thefts` - –∫—Ä–∞–∂–∏ –ª–∏—Å—ã
- `beaver_protections` - –∑–∞—â–∏—Ç—ã –±–æ–±—Ä–∞

### ‚úÖ **–ò–≥—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è:**
- –ü—Ä–∏ –ø–æ–±–µ–¥–µ —Ö–∏—â–Ω–∏–∫–æ–≤ (–≤–æ–ª–∫–∏ + –ª–∏—Å–∞)
- –ü—Ä–∏ –ø–æ–±–µ–¥–µ —Ç—Ä–∞–≤–æ—è–¥–Ω—ã—Ö (–∑–∞–π—Ü—ã + –∫—Ä–æ—Ç + –±–æ–±–µ—Ä)
- –ü—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

---

## üìä **–ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
ERROR:asyncio:Task exception was never retrieved
AttributeError: 'Game' object has no attribute 'herbivore_survivals'
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
INFO:__main__:–í—Å–µ –∏–≥—Ä–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –Ω–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è! –ó–∞–≤–µ—Ä—à–∞–µ–º –Ω–æ—á—å –¥–æ—Å—Ä–æ—á–Ω–æ.
INFO:__main__:–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ü–æ–±–µ–¥–∏–ª–∞ –∫–æ–º–∞–Ω–¥–∞: Team.PREDATORS
```

---

## üéâ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

**–í—Å–µ –æ—à–∏–±–∫–∏ –≤ –Ω–æ—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!**

- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –æ—à–∏–±–∫–∞ `AttributeError`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã `end_game_winner`
- ‚úÖ –ò–≥—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–±–µ–¥–µ –≤–æ–ª–∫–æ–≤
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!**

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 9 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: ‚úÖ –ü–†–û–ô–î–ï–ù–û